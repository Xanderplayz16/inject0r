let exhub = openWindow(450, 350, "Exploit Hub", resizable = "on", Injector.user.icons.ExpHub)
exhub.style.backgroundColor = "#454545";
let numBtn = 0;
exhub.innerHTML = `
<gamingheader id="topdog"></gamingheader>
<seperator id="seperator"></seperator>
<div id="buttonlist" class="expButtonList">
<bruh class="expButton" id="stoopybtn">History Flooder</bruh>
<bruh class="expButton" id="editbtn">Edit Page</bruh>
<bruh class="expButton" id="tabname">Change Tabname</bruh>
<bruh class="expButton" id="gdrivecloak">Drive Cloak</bruh>
<bruh class="expButton" id="gclasscloak">Classroom Cloak</bruh>
<bruh class="expButton" id="antiexten" 0>Anti-Extension</bruh>
<bruh class="expButton" id="testings" 0>size test</bruh> 

</div>
<style id="expstyle"> </style>
<text1 id="headerTxt"></text1>
<text2 id="descTxt"></text2>`
//main
let floodBtn = document.getElementById("stoopybtn");
let header = document.getElementById("topdog");
let expstyle = document.getElementById("expstyle");
//exploits
//buttonlist is the container for buttons
let buttonlist = document.querySelector("#buttonlist");
let editBtn = document.getElementById("editbtn");
let seperator = document.getElementById("seperator");
let headerText = document.getElementById("headerTxt");
let descText = document.getElementById("descTxt");
let tabBtn = document.getElementById("tabname");
let noExtension = document.getElementById("antiexten");
let driveCloak = document.querySelector("#gdrivecloak");
let sizetest = document.querySelector("#testings");
let gclassCloak = document.querySelector("#gclasscloak");
// lets me create more buttons later on without cancer cause im lazy
buttonCSS(floodBtn, headerText, descText, "Floods your history with the page you are currently visiting. Keep in mind they can still scroll down far enough, so reliance on this is discouraged.");
buttonCSS(editBtn, headerText, descText, "Allows you to edit the page you're currently visiting. You cannot edit the contents of Injector. After editing the page, disabling this will lock in your changes to the page. Keep in mind this is only for you, and refreshing will revert these changes.");
buttonCSS(tabBtn, headerText, descText, "Changes the current name of the tab you're on. Can be used to trick teachers (make game sites look like Google Classroom, ect). If you dont set anything than it defaults to Google Drive, your welcome ;)");
buttonCSS(driveCloak, headerText, descText, "Cloaks the tab as Google Drive. Similar use of the Change Tab Name exploit, but more convincing as it changes the icon.");
buttonCSS(noExtension, headerText, descText, "Go to the Chrome Web Store, and activate this bookmark. It will disable the extension you enter in, its like manually turning it off in settings.");
buttonCSS(sizetest, headerText, descText, "this is a size test that does nothing \n Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean dictum fermentum elit, eu fermentum neque posuere ac. Praesent pretium odio sed odio laoreet imperdiet. Nunc interdum bibendum lobortis. Vivamus quam diam, tincidunt id dignissim vel, imperdiet sed elit. Etiam facilisis purus non turpis commodo pellentesque. Mauris posuere egestas varius. Donec nisi nunc, luctus eget semper ac, ultricies sit amet arcu.");
buttonCSS(gclassCloak, headerText, descText, "Cloaks the tab as Google Classroom. Similar use of the Change Tab Name exploit, but more convincing as it changes the icon.");

//trying to make buttons scroll...
//buttonlist.style.overflow = "scroll";
//buttonlist.height = '330px';

// COLORS
var green = "#25cc00";
var blue = "#1c59ff";

//style
expstyle.innerHTML = `
    .expButton {
        width = 42%;
        padding = 2px;
        position = absolute;
    }
    #buttonlist {
        position: absolute;
        bottom: 0px;
        left: 0px;
        width: 50%;
        height: calc(100% - 50px);
        border-color: gray;
        border-style: none solid none none;
        overflow: hidden auto;
    }


`
//position: absolute; bottom: 0px; left: 0px; width: 150px; height: calc(100% - 50px); border-color: gray; border-style: none solid none none; overflow: hidden auto; --darkreader-inline-border-top:#545b5e; --darkreader-inline-border-right:#545b5e; --darkreader-inline-border-bottom:#545b5e; --darkreader-inline-border-left:#545b5e;

floodBtn.style.top = "10px";
editBtn.style.top = "60px";
tabBtn.style.top = "110px";
driveCloak.style.top = "160px";
gclassCloak.style.top = "210px";
noExtension.style.top = "260px";
sizetest.style.top = "310px";

//floodBtn.style.grid-column = 1;
//editBtn.style.grid-column = 2;
//tabBtn.style.grid-column = 3;
//driveCloak.style.grid-column = 4;
//noExtension.style.grid-column = 5;
//sizetest.style.grid-column = 6;

// make the header bar
header.style.position = "absolute";
header.style.width = "100%";
header.style.height = "50px";
header.style.backgroundColor = "#2a4dad";
header.style.color = "white";
header.textContent = "Exploit Hub v1.1";
header.style.top = "0px";
header.style.marginTop = "0px";
header.style.userSelect = "none";
header.style.fontSize = "35px";
header.style.textAlign = "center";
header.style.lineHeight = "50px";

//make text-description seperator
//
seperator.style.position = "absolute";
seperator.style.width = "2px";
//test
seperator.style.height = "calc(100% - 50px)"
//			seperator.style.height = "100%"
seperator.style.top = "50px";
seperator.style.bottom = '0px';
seperator.style.backgroundColor = "white";
seperator.style.left = "46.25%";

// text boxes
headerText.style.position = "absolute";
headerText.style.right = "0px";
headerText.style.top = "50px";
headerText.style.width = "45%"
headerText.style.height = "50px";
headerText.style.color = "white";
headerText.style.fontFamily = "Helvetica";
headerText.style.fontSize = "25px";
headerText.style.textAlign = "center";
headerText.style.lineHeight = "50px";
headerText.textContent = "Welcome!"
descText.style.position = "absolute";
descText.style.right = "2px";
descText.style.top = "100px";
descText.style.width = "45%"
descText.style.height = "calc(100% - 50px)";
descText.style.color = "white";
descText.style.fontFamily = "Helvetica";
descText.style.fontSize = "15px";
descText.style.lineHeight = "19px";
descText.textContent = "Hover over a button to see what it does!"
let driveCloakEnabled = false;
let ico = null;
let link = null;
driveCloak.addEventListener("click", function() {
    if (!driveCloakEnabled) {
        driveCloakEnabled = true;
        link = document.querySelector("link[rel~='icon']");
        if (!link) {
            link = document.createElement('link');
            link.rel = 'icon';
            document.getElementsByTagName('head')[0].appendChild(link);
            ico = ""
        }
        link.href = 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/1147px-Google_Drive_icon_%282020%29.svg.png';
        document.title = "My Drive - Google Drive"
        driveCloak.classList.add('enabled');
    } else {
        driveCloakEnabled = false;
        driveCloak.classList.remove('enabled');
        link.href = ico;
    }
})

gclassCloak.addEventListener("click", function() {
    // function gcloak() {
        var link = document.querySelector("link[rel*='icon']") || document.createElement('link');link.type = 'image/x-icon';link.rel = 'shortcut icon';link.href = 'https://ssl.gstatic.com/classroom/favicon.png';document.title = 'Classes';console.log(document.title);document.getElementsByTagName('head')[0].appendChild(link) 
    // };gcloak();setInterval(gcloak, 1000);
})
let floodEnabled = false;
let editEnabled = false;
let count = 0;
floodBtn.addEventListener("click", function() {
    if (!floodEnabled) {
        floodEnabled = true;
        var t = "/";
        o = "f_";
        var permCount = 0;


        var flooder = setInterval(function() {
            floodBtn.style.backgroundColor = green;
            if (floodEnabled) {
                if (permCount > 45) {
                    history.pushState(0, 0, "/")
                    t = "/";
                    o = "f_";
                    permCount = 0;
                }
                history.pushState(0, 0, t += o.toString() + count.toString());

                count++;
                permCount++;
            } else {
                clearInterval(flooder);
                floodBtn.style.backgroundColor = blue;
            }
        }, 35);

    } else {
        floodEnabled = false;
        history.pushState(0, 0, "/")
        floodBtn.style.backgroundColor = "#1c59ff";
    };
})
editBtn.addEventListener("click", function() {
    if (!editEnabled) {
        //green?
        editBtn.style.backgroundColor = "#25cc00"

        document.body.contentEditable = true;
        background.contentEditable = false;
        backgroundImage.contentEditable = false;
        editEnabled = true;
        editUsed = true;
    } else {
        document.body.contentEditable = false;
        editBtn.style.backgroundColor = "#0031b5";
        editEnabled = false;
        editUsed = false;
    }

})
//only works in the bookmarklet :( 
//fun fact, it works on any page on the chrome.google.com domain, so webstorex works, but so does webstoree or webstoreyay
// 			 noExtension.addEventListener("click", function(){
// 	if (window.location.href.indexOf("https://chrome.google.com/webstore") > -1){
// 						if (confirm("you must be on the chrome extension store page, click ok to redirect to page, or cancel to cancel")) {
// 						alert("Relaunch inject0r once page has loaded and click the Anti-Extension button again :)")
// 							window.location.replace("https://chrome.google.com/webstore-injredirect")
// 						} else {
// 							alert("Canceled :(")
// 						}
// 				 } else {
// 				 prompt('Extension IDs here: (seperated by commas for m nultiple)').split(',').forEach(i => {
//     chrome.management.setEnabled(i, !1)
// })}
// 			 });

noExtension.addEventListener("click", function() {
    var win = window.location.href;
    var check = win.startsWith("https://chrome.google.com/webstore");
    alert(win);
    if (check) {
        prompt('Extension IDs here: (seperated by commas for multiple)').split(',').forEach(i => {
            chrome.management.setEnabled(i, !1)
        })
    }
    else if (!(check)) {
        alert(`Wrong Page redirecting, once redirected relaunch ${Injector.clientconfig.brand} and re-click Anti Extension.`)
        window.location.replace("https://chrome.google.com/webstoreinject");
    }
});

tabBtn.addEventListener("click", function() {
    /*var user_input = prompt("Type new tab name");
    if (document.title = 'null') {
        link = document.querySelector("link[rel~='icon']");
        if (!link) {
            link = document.createElement('link');
            link.rel = 'icon';
            document.getElementsByTagName('head')[0].appendChild(link);
            ico = ""
        }
        link.href = 'https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/1147px-Google_Drive_icon_%282020%29.svg.png';
        document.title = user_input;
    }*/

    var link = document.querySelector("link[rel*='icon']") || document.createElement('link');link.type = 'image/x-icon';link.rel = 'shortcut icon';link.href = prompt('URL for icon?','https://ssl.gstatic.com/classroom/favicon.png');document.title = prompt('Title?','Classes');console.log(document.title);document.getElementsByTagName('head')[0].appendChild(link)
    
});